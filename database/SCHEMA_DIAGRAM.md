# ğŸ“Š LearnSphere Database Schema Diagram

## Entity Relationship Diagram (ERD)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LEARNSPHERE DATABASE SCHEMA                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       USERS          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id (UUID)         â”‚
â”‚    email             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    password_hash     â”‚         â”‚
â”‚    name              â”‚         â”‚
â”‚    role              â”‚         â”‚
â”‚    total_points      â”‚         â”‚
â”‚    badge_level       â”‚         â”‚
â”‚    is_active         â”‚         â”‚
â”‚    created_at        â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
         â”‚                       â”‚
         â”‚ instructor_id         â”‚ user_id
         â”‚                       â”‚
         â–¼                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚      COURSES         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚ PK id (UUID)         â”‚         â”‚
â”‚ FK instructor_id     â”‚         â”‚
â”‚    title             â”‚         â”‚
â”‚    description       â”‚         â”‚
â”‚    cover_image_url   â”‚         â”‚
â”‚    category          â”‚         â”‚
â”‚    difficulty_level  â”‚         â”‚
â”‚    is_published      â”‚         â”‚
â”‚    average_rating    â”‚         â”‚
â”‚    total_reviews     â”‚         â”‚
â”‚    total_enrollments â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
         â”‚                       â”‚
         â”‚ course_id             â”‚
         â”‚                       â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚              â”‚
         â–¼                       â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      LESSONS         â”‚  â”‚    ENROLLMENTS       â”‚  â”‚      REVIEWS         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id (UUID)         â”‚  â”‚ PK id (UUID)         â”‚  â”‚ PK id (UUID)         â”‚
â”‚ FK course_id         â”‚  â”‚ FK user_id           â”‚  â”‚ FK course_id         â”‚
â”‚    title             â”‚  â”‚ FK course_id         â”‚  â”‚ FK user_id           â”‚
â”‚    description       â”‚  â”‚    enrollment_date   â”‚  â”‚    rating (1-5)      â”‚
â”‚    lesson_type       â”‚  â”‚    completion_date   â”‚  â”‚    comment           â”‚
â”‚    content_url       â”‚  â”‚    progress_%        â”‚  â”‚    is_approved       â”‚
â”‚    content_text      â”‚  â”‚    is_completed      â”‚  â”‚    created_at        â”‚
â”‚    duration          â”‚  â”‚    last_accessed     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    order_index       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    is_preview        â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ enrollment_id
         â”‚                         â”‚
         â”‚ lesson_id               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                         â”‚                  â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
         â”‚                         â”‚          â”‚       â”‚
         â–¼                         â–¼          â–¼       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      QUIZZES         â”‚  â”‚  LESSON_PROGRESS     â”‚  â”‚   QUIZ_ATTEMPTS      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id (UUID)         â”‚  â”‚ PK id (UUID)         â”‚  â”‚ PK id (UUID)         â”‚
â”‚ FK lesson_id         â”‚  â”‚ FK enrollment_id     â”‚  â”‚ FK enrollment_id     â”‚
â”‚    title             â”‚  â”‚ FK lesson_id         â”‚  â”‚ FK quiz_id           â”‚
â”‚    description       â”‚  â”‚    status            â”‚  â”‚    attempt_number    â”‚
â”‚    passing_score     â”‚  â”‚    started_at        â”‚  â”‚    score             â”‚
â”‚    points_1st_try    â”‚  â”‚    completed_at      â”‚  â”‚    points_earned     â”‚
â”‚    points_2nd_try    â”‚  â”‚    time_spent        â”‚  â”‚    is_passed         â”‚
â”‚    points_3rd_try    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    started_at        â”‚
â”‚    points_more       â”‚                            â”‚    completed_at      â”‚
â”‚    time_limit        â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
         â”‚                                                   â”‚ attempt_id
         â”‚ quiz_id                                           â”‚
         â”‚                                                   â–¼
         â–¼                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚   QUIZ_ANSWERS       â”‚
â”‚  QUIZ_QUESTIONS      â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚ PK id (UUID)         â”‚
â”‚ PK id (UUID)         â”‚                           â”‚ FK attempt_id        â”‚
â”‚ FK quiz_id           â”‚                           â”‚ FK question_id       â”‚
â”‚    question_text     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ FK selected_option   â”‚
â”‚    question_type     â”‚                           â”‚    is_correct        â”‚
â”‚    order_index       â”‚                           â”‚    answered_at       â”‚
â”‚    points            â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ question_id
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   QUIZ_OPTIONS       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id (UUID)         â”‚
â”‚ FK question_id       â”‚
â”‚    option_text       â”‚
â”‚    is_correct        â”‚
â”‚    order_index       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        TAGS          â”‚         â”‚      BADGES          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id (UUID)         â”‚         â”‚ PK id (UUID)         â”‚
â”‚    name              â”‚         â”‚    name              â”‚
â”‚    created_at        â”‚         â”‚    description       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    icon_url          â”‚
         â”‚                       â”‚    points_required   â”‚
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                â”‚
         â–¼                                â”‚ badge_id
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   COURSE_TAGS        â”‚                 â–¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PK course_id         â”‚         â”‚   USER_BADGES        â”‚
â”‚ PK tag_id            â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ PK id (UUID)         â”‚
                                 â”‚ FK user_id           â”‚
                                 â”‚ FK badge_id          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    earned_at         â”‚
â”‚  LESSON_ATTACHMENTS  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK id (UUID)         â”‚
â”‚ FK lesson_id         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    name              â”‚         â”‚   NOTIFICATIONS      â”‚
â”‚    file_type         â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    url               â”‚         â”‚ PK id (UUID)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ FK user_id           â”‚
                                 â”‚    title             â”‚
                                 â”‚    message           â”‚
                                 â”‚    type              â”‚
                                 â”‚    is_read           â”‚
                                 â”‚    created_at        â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”‘ Key Relationships

### One-to-Many (1:N)
- Users â†’ Courses (instructor)
- Users â†’ Enrollments
- Users â†’ Reviews
- Courses â†’ Lessons
- Courses â†’ Enrollments
- Courses â†’ Reviews
- Lessons â†’ Quizzes
- Enrollments â†’ Lesson Progress
- Enrollments â†’ Quiz Attempts
- Quizzes â†’ Questions
- Questions â†’ Options

### Many-to-Many (M:N)
- Courses â†” Tags (via course_tags)
- Users â†” Badges (via user_badges)

### One-to-One (1:1)
- Lessons â†’ Quizzes (optional)

## ğŸ“ˆ Indexes Summary

**Primary Indexes (PKs):** 17 tables
**Foreign Key Indexes:** 25+
**Composite Indexes:** 5+
**Unique Constraints:** 8

## ğŸ¯ Cascade Rules

**ON DELETE CASCADE:**
- Deleting user â†’ deletes enrollments, reviews
- Deleting course â†’ deletes lessons, enrollments, reviews
- Deleting lesson â†’ deletes quizzes, progress
- Deleting quiz â†’ deletes questions, attempts

**ON DELETE SET NULL:**
- Deleting option â†’ sets quiz_answers.selected_option to NULL

## âš¡ Triggers

1. **update_updated_at_column** â†’ Auto-update timestamps
2. **trigger_update_course_rating** â†’ Recalculate average rating
3. **trigger_update_badge_level** â†’ Update user badge based on points

## ğŸ“Š Views

1. **course_analytics** â†’ Instructor dashboard metrics
2. **user_learning_stats** â†’ Learner progress tracking
